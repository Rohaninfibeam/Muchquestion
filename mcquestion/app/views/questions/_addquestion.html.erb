<script type="text/javascript">
	$(document).ready(function(){
		$(".add-question,.add-option,.add-questiontype").unbind('click').click(initfunction);
		$(".question-sortable,.option-sortable,.questiontype-sortable").sortable();
		function initfunction(){
			console.log("hey bob");
			button=$(this).data("name");
			length=$("#".concat(button,"-type")).children('div').length
			clonedtype=$(this).parent().find("#".concat(button,"-type")).children().last().clone();
			$(this).parent().find("#".concat(button,"-type")).append(clonedtype)
			$(this).parent().find("#".concat(button,"-type")).children().last().find(":input").each(function(){
				this.name=this.name.replace(this.name.substr(this.name.indexOf(button)),this.name.substr(this.name.indexOf(button)).replace(/[0-9]+/,length))
			});

		}
	});

	// $(function(){
	// 	$( ".question-sortable,.option-sortable,.questiontype-sortable").sortable({
 //      		revert: true
 //    	});
	// });
</script>
<br>
<div class="form-group">
	<label>Question name</label>
	<%=f.text_field :name, class: "form-control"%>
</div>
<div class="form-group">
	<label>Question</label>
	<%=f.text_area :question, class: "form-control", rows: "5"%>
</div>
	
<span class="glyphicon glyphicon-plus" id="add-option"></span>
<div id="option-type" class="option-sortable">
	<%=f.fields_for :options do |opti|%>
		<div>
			options <%=opti.check_box :istrue%>
			<%=opti.text_field :value%>
			<span class="glyphicon glyphicon-remove-sign"></span>
		</div>
	<% end %>
</div>
<br>
<div>
	Question Type <%=f.collection_select :questiontype_ids, Questiontype.all, :id, :qtype,{},{:multiple => true} %>
</div>
<br>

<span class="glyphicon glyphicon-plus" id="add-questiontype"></span>
<div id="questiontype-type" class="questiontype-sortable">
	<%=f.fields_for :questiontypes do |qtyp|%>
		<div>
			Add Question type <%=qtyp.text_field :qtype%>
			<span class="glyphicon glyphicon-remove-sign"></span>
		</div>
	<% end %>
</div>
<br>
